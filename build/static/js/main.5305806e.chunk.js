(this["webpackJsonpphaser-mp"]=this["webpackJsonpphaser-mp"]||[]).push([[0],{1538:function(e,t){},1541:function(e,t,s){},1542:function(e,t,s){"use strict";s.r(t),s.d(t,"config",(function(){return T}));var i=s(583),n=s.n(i),a=(s(595),s(12)),o=s.n(a),r=s(44),c=s(45),h=s(106),l=s(47),u=s(46),d=s(584),p=s.n(d),y=s(585),b=s.n(y),f=s(586),m=s.n(f),v=s(86),_=s(589),x=function(e){Object(l.a)(s,e);var t=Object(u.a)(s);function s(e,i,n){return Object(r.a)(this,s),t.call(this,e,i,n,"bullet")}return Object(c.a)(s,[{key:"fire",value:function(e,t,s){var i={0:[0,-750],"-90":[-750,0],90:[750,0],"-180":[0,750],45:[750,-750],"-45":[-750,-750],135:[750,750],"-135":[-750,750]};this.body.reset(e,t),this.setAngle(s),this.setActive(!0),this.setVisible(!0),this.setVelocityY(i[String(parseInt(s))][1]),this.setVelocityX(i[String(parseInt(s))][0])}},{key:"preUpdate",value:function(e,t){Object(_.a)(Object(v.a)(s.prototype),"preUpdate",this).call(this,e,t),(this.y<=-10||this.y>=610||this.x<=-10||this.x>=810)&&this.set_bullet(!1)}},{key:"set_bullet",value:function(e){this.setActive(e),this.setVisible(e)}}]),s}(o.a.Physics.Arcade.Sprite),g=function(e){Object(l.a)(s,e);var t=Object(u.a)(s);function s(e){var i;return Object(r.a)(this,s),(i=t.call(this,e.physics.world,e)).disabled=!1,i.createMultiple({frameQuantity:5,key:"bullet",active:!1,visible:!1,classType:x}),i}return Object(c.a)(s,[{key:"fireBullet",value:function(e,t,s){var i=this.getFirstDead(!1);i&&i.fire(e,t,s)}},{key:"get_all_bullets",value:function(){return this.children.entries.map((function(e){return{x:e.x,y:e.y,angle:e.angle,active:e.active,visible:e.visible}}))}}]),s}(o.a.Physics.Arcade.Group),k=s(587),w=s.n(k),O=s(588),j=s.n(O),A=function(e){Object(l.a)(s,e);var t=Object(u.a)(s);function s(){var e;Object(r.a)(this,s);for(var i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))).get_new_spaceship=function(t,s,i,n,a){var o=e.add.text(-30,25,"".concat(n,": ").concat(i),{color:"#00ff00",align:"center",fontSize:"13px"}),r=e.add.sprite(0,0,"ship");r.setAngle(a);var c=e.add.container(t,s,[r,o]);return c.setSize(45,45),e.physics.add.existing(c,!1),e.physics.add.existing(r,!1),c.body.setCollideWorldBounds(!0),{score_text:o,ship:r,cont:c}},e.emit_coordinates=function(){e.socket.emit("update_coordinates",{x:e.ship.cont.x,y:e.ship.cont.y,score:e.score,name:e.name,angle:e.ship.ship.angle,bullets:e.bullets.get_all_bullets(e.socket.id)})},e.get_coin=function(t,s){var i=e.add.sprite(t,s,"coin");return e.physics.add.existing(i,!1),e.physics.add.collider(i,e.ship.ship,e.fire,null,Object(h.a)(e)),i},e.fire=function(t){t.x=o.a.Math.Between(20,780),t.y=o.a.Math.Between(20,580),e.score+=5,e.ship.score_text.setText("".concat(e.name,": ").concat(e.score)),e.socket.emit("update_coin",{x:t.x,y:t.y}),e.check_for_winner(e.score)},e.get_enemy_bullets=function(t,s){for(var i=new g(Object(h.a)(e)),n=function(n){i.children.entries[n].setAngle(t[n].angle),i.children.entries[n].setActive(t[n].active),i.children.entries[n].setVisible(t[n].visible),i.children.entries[n].x=t[n].x,i.children.entries[n].y=t[n].y,e.physics.add.collider(i.children.entries[n],e.ship.ship,(function(t){t.disabled?setTimeout((function(){t.disabled=!1}),100):(e.emmit_collision(s,n),e.animate_explosion("0"),t.disabled=!0)}),null,Object(h.a)(e))},a=0;a<t.length;a++)n(a);return i},e.update_enemy_bullets=function(t,s){for(var i=e.others[t].bullets,n=0;n<s.length;n++)i.children.entries[n].x=s[n].x,i.children.entries[n].y=s[n].y,i.children.entries[n].setAngle(s[n].angle),i.children.entries[n].setActive(s[n].active),i.children.entries[n].setVisible(s[n].visible)},e.emmit_collision=function(t,s){e.socket.emit("collision",{bullet_user_id:t,bullet_index:s})},e.animate_explosion=function(t){var s;"0"===t?((s=e.ship.cont).setActive(!1),e.score=Math.max(0,e.score-2),e.ship.score_text.setText("".concat(e.name,": ").concat(e.score)),setTimeout((function(){s.setActive(!0)}),1e3)):s=e.others[t].ship.cont,e.add.sprite(s.x,s.y,"boom").anims.play("explode")},e.check_for_winner=function(t){if(t>=100){var s=[{name:e.name,score:e.score}];for(var i in e.others)s.push({name:e.others[i].name,score:e.others[i].score});s=s.sort((function(e,t){return t.score-e.score})),setTimeout((function(){return e.socket.disconnect()}),20),e.scene.start("winner",s)}},e}return Object(c.a)(s,[{key:"init",value:function(e){this.ENDPOINT="https://phaser3-game-react.herokuapp.com",console.log(this.ENDPOINT),this.name=e,this.keys=this.input.keyboard.createCursorKeys(),this.space=this.input.keyboard.addKey(o.a.Input.Keyboard.KeyCodes.SPACE),this.score=0,this.others={},this.x=o.a.Math.Between(50,750),this.y=o.a.Math.Between(50,550)}},{key:"preload",value:function(){this.load.spritesheet("boom",w.a,{frameWidth:64,frameHeight:64,endFrame:23}),this.load.image("coin",p.a),this.load.image("ship",b.a),this.load.image("bullet",m.a)}},{key:"create",value:function(){var e=this,t={key:"explode",frames:this.anims.generateFrameNumbers("boom",{start:0,end:23,first:23}),frameRate:20};this.anims.create(t),this.ship=this.get_new_spaceship(this.x,this.y,this.score,this.name,0),this.socket=j()(this.ENDPOINT),this.bullets=new g(this),this.socket.on("to_new_user",(function(t,s){e.id=t.id,e.others=t.others;for(var i=0,n=Object.keys(e.others);i<n.length;i++){var a=n[i],o=e.others[a].x,r=e.others[a].y,c=e.others[a].score,h=e.others[a].name,l=e.others[a].angle,u=e.others[a].bullets;e.others[a].ship=e.get_new_spaceship(o,r,c,h,l),e.others[a].bullets=e.get_enemy_bullets(u,a),e.others[a].score=c,e.others[a].name=h,e.check_for_winner(c)}e.coin=e.get_coin(t.coin.x,t.coin.y),e.emit_coordinates()})),this.socket.on("to_others",(function(t,s){var i=t.id,n=t.x,a=t.y,o=t.score,r=t.name,c=t.angle,h=t.bullets;if(i in e.others)e.others[i].ship.cont.x=n,e.others[i].ship.cont.y=a,e.others[i].ship.score_text.setText("".concat(r,": ").concat(o)),e.others[i].ship.ship.setAngle(c),e.update_enemy_bullets(i,h),e.others[i].score=o,e.others[i].name=r;else{var l=e.get_new_spaceship(n,a,o,r,c),u=e.get_enemy_bullets(h,i);e.others[i]={x:n,y:a,ship:l,bullets:u,score:o,name:r}}e.check_for_winner(o)})),this.socket.on("coin_changed",(function(t,s){e.coin.x=t.coin.x,e.coin.y=t.coin.y})),this.socket.on("other_collision",(function(t,s){var i=t.bullet_user_id,n=t.bullet_index,a=t.exploded_user_id;i===e.socket.id&&e.bullets.children.entries[n].set_bullet(!1),e.animate_explosion(a)})),this.socket.on("user_disconnected",(function(t,s){e.others[t.id].ship.score_text.destroy(),e.others[t.id].ship.ship.destroy(),e.others[t.id].ship.cont.destroy(),delete e.others[t.id]}))}},{key:"update",value:function(){var e=this.ship.cont,t=this.ship.ship,s="";this.keys.down.isDown&&e.active&&(e.y+=7,s+="d"),this.keys.up.isDown&&e.active&&(e.y-=7,s+="u"),this.keys.right.isDown&&e.active&&(e.x+=7,s+="r"),this.keys.left.isDown&&e.active&&(e.x-=7,s+="l");var i={u:0,d:180,l:270,r:90,ur:45,ul:-45,dr:135,dl:225};s in i&&t.setAngle(i[s]),o.a.Input.Keyboard.JustDown(this.space)&&this.bullets.fireBullet(this.ship.cont.x,this.ship.cont.y-5,this.ship.ship.angle),this.emit_coordinates()}}]),s}(o.a.Scene),K=function(e){Object(l.a)(s,e);var t=Object(u.a)(s);function s(){return Object(r.a)(this,s),t.apply(this,arguments)}return Object(c.a)(s,[{key:"init",value:function(){var e="abcdefghijklmnopqrstuvwxyz".split("").join(",");this.keys=this.input.keyboard.addKeys(e),this.backspace=this.input.keyboard.addKey(o.a.Input.Keyboard.KeyCodes.BACKSPACE),this.enter=this.input.keyboard.addKey(o.a.Input.Keyboard.KeyCodes.ENTER)}},{key:"create",value:function(){this.welcome_text="Welcome, enter your name\n\n",this.text=this.add.text(250,250,this.welcome_text,{color:"#00ff00",align:"center",fontSize:"20px"}),this.name=""}},{key:"update",value:function(){for(var e=0,t=Object.keys(this.keys);e<t.length;e++){var s=t[e];o.a.Input.Keyboard.JustDown(this.keys[s])&&this.name.length<15&&(this.name+=s)}o.a.Input.Keyboard.JustDown(this.backspace)&&(this.name=this.name.substring(0,this.name.length-1)),o.a.Input.Keyboard.JustDown(this.enter)&&this.scene.start("playgame",this.name),this.text.setText(this.welcome_text+this.name)}}]),s}(o.a.Scene),I=function(e){Object(l.a)(s,e);var t=Object(u.a)(s);function s(){return Object(r.a)(this,s),t.apply(this,arguments)}return Object(c.a)(s,[{key:"init",value:function(e){this.players=e,this.enter=this.input.keyboard.addKey(o.a.Input.Keyboard.KeyCodes.ENTER)}},{key:"create",value:function(){for(var e in this.winner_text="Winner is ".concat(this.players[0].name,"\n\nScoreboard:\n--------------------\n"),this.players)this.winner_text+="".concat(this.players[e].name,": ").concat(this.players[e].score,"\n");this.winner_text+="\n\nPress Enter to play again",this.text=this.add.text(250,50,this.winner_text,{color:"#00ff00",align:"center",fontSize:"20px"})}},{key:"update",value:function(){this.enter.isDown&&this.scene.start("playgame")}}]),s}(o.a.Scene);s(127),s(1541);var T={type:o.a.AUTO,width:800,height:600,physics:{default:"arcade"},backgroundColor:"#202830"},D=new o.a.Game(T);D.scene.add("playgame",A),D.scene.add("welcome",K),D.scene.add("winner",I),D.scene.start("welcome"),n.a.render(null,document.getElementById("root"))},584:function(e,t,s){e.exports=s.p+"static/media/coin.87cc3c60.svg"},585:function(e,t,s){e.exports=s.p+"static/media/spaceship.1121fa40.svg"},586:function(e,t,s){e.exports=s.p+"static/media/bullet.419a6b56.svg"},587:function(e,t,s){e.exports=s.p+"static/media/explosion.5ddcf208.png"},590:function(e,t,s){e.exports=s(1542)},595:function(e,t,s){}},[[590,1,2]]]);
//# sourceMappingURL=main.5305806e.chunk.js.map